% The file is a script file that provides data of a specific directional
% valve. The data is arranged as a structure with the following fields:
%   contr_signal - vector of control signals which were applied to valve
%                   during measurements. The values must be monotonically
%                   increasing in positive direction and cover all the 
%                   valve operation range. All the valve measurements must
%       `           be performed at these values only.
%   q_external   - vector of flow rates (m^3/s) through the external loop
%                   at no load,
%   p_A            - pressure (Pa) at A port at no flow rate in the external
%                   loop,
%   p_B            - pressure (Pa) at B port at no flow rate in the external
%                   loop,
%   q_leak         - leakage flow rate (m^3/s) measured in the return line
%                    at no flow in the external loop,
%   p_S            - supply pressure (Pa),
%   p_R            - pressure (Pa) in the return line,
%   C_d ``         - Flow discharge coefficient,
%   density        - fluid density (kg/m^3),
% orifice_orientation - vector of orifice orientation identifiers. The
%                   orifice which opens in positive direction is marked
%                   with 1, the orifice which opens in negative direction
%                   must be specified with -1
% Copyright 2010 The MathWorks, Inc.

valve_data = struct('contr_signal', ...
    [-10    -7.85   -5.71   -3.57   -1.42    -0.357  -0.285 ...
    -0.214  -0.143  -0.071  -0.035  -0.0286 -0.0215  -0.0143 ...
    -0.00714  0 ...
    0.00714  0.0143  0.0214  0.0286   0.0357  0.071  0.143 ...
    0.214    0.285   0.357   1.42    3.57  5.71  7.85   10], ...
    'q_external', ...
    [-3.2313e+03  -2.6379e+03  -2.0571e+03  -1.3607e+03  -5.4275e+02  ...
     -1.2940e+02  -1.0004e+02  -8.0000e+01  -5.0010e+01  -2.0900e+01 ...
     -1.2920e+01  -1.0010e+01  -7.2700e+00  -4.4800e+00  -1.6500e+00 ...
     -1e-8 ...
     1.6495e+00   4.4910e+00   7.2712e+00   1.0012e+01   1.2934e+01  ...
     2.0816e+01   5.0008e+01   8.0010e+01   1.0000e+02   1.2864e+02 ...
     5.4216e+02   1.3508e+03   2.05111e+03  2.6411e+03   3.2316e+03] ...
     * 1e-6, ...           
     'p_A', ...
     [10.0005   10.0007   10.0011   10.0020   10.0090   10.0614   10.1741 ...
      17.2164   39.5722   83.1121  111.9988  117.4641  123.6053  129.8969 ...
      136.1964  142.5100  148.8034 155.1030  161.3078  167.5359  173.5948 ...
      201.8903  245.4373  267.7794 274.8259  274.9386  274.9919  274.9980 ...
      274.9991  274.9994  274.9995] * 1e5, ...    
     'p_B', ...
      [274.9995  274.9993  274.9989  274.9980  274.9910  274.9386 ...
       274.8259  267.7836  245.4278  201.8879  173.0012  167.5359 ...
       161.3947  155.1031  148.8036  142.4900  136.1966  129.8970 ...
       123.6922  117.4641  111.4052   83.1097   39.5627   17.2206 ...
        10.1741   10.0614   10.0081   10.0020   10.0009   10.0006 ...
        10.0005] * 1e5, ...
      'q_leak', ...
      [3.11     3.72      4.33      4.94      5.542      5.85      5.87   ...
       5.8907   10.2771   13.5330   14.4339   14.5325   14.6192   14.6822 ...
      14.7198   14.7323   ...
      14.7198   14.6821   14.6202   14.5324   14.4218   13.5333   10.2772 ...
      5.8905    5.874     5.85      5.55     4.95    4.32     3.718  ...
      3.106  ] * 1e-6, ...
     'p_S',275e5, 'p_R',10e5, 'C_d', 0.7, 'density',850, ...
     'orifice_orientation', [-1 1 -1 1]);

% ONLY RUN THIS SECTION IF NECESSARY TO GENERATE PLOTS
%{
% CALCULATE ORIFICE AREAS AT EACH LEVEL OF CONTROL SIGNAL
[area, contr_signal] = dir_valve_area_characterization(valve_data);
 
% PLOT AREA vs. CONTROL SIGNAL
figure;
plot(contr_signal,area(5,:),'LineWidth',3);
xlabel('Control Signal (V)','FontSize',14);
ylabel('Orifice Area (mm^2)','FontSize',14);
title('Orifice Area vs. Control Signal','FontSize',16,'FontWeight','Bold');
grid on 

% ZOOM IN ON AXIS
axis([-2 0.2 -1e-8 15e-8]);
%}

 