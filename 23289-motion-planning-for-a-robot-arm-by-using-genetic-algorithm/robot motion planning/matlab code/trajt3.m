function www=trajt3(para,chrom)

x0=para(1);
y0=para(2);
z0=para(3);
vx0=0;
vy0=0;
vz0=0;
ax0=0;
ay0=0;
az0=0;
x2=para(4);
y2=para(5);
z2=para(6);
vx2=0;
vy2=0; 
vz2=0;
ax2=0;
ay2=0;
az2=0;
x1=chrom(1);
y1=chrom(2);
z1=chrom(3);
vx1=chrom(4);
vy1=chrom(5);
vz1=chrom(6);
t1=chrom(7);
t2=chrom(8);

a00=x0;
a01=vx0;
a02=ax0/2;
a03=(4*x1-vx1*t1-4*x0-3*vx0*t1-ax0*t1^2)/t1^3;
a04=(vx1*t1-3*x1+3*x0+2*vx0*t1+ax0*t1^2/2)/t1^4;
ax1=2*a02+6*a03*t1+12*a04*t1^2;

c00=y0;
c01=vy0;
c02=ay0/2;
c03=(4*y1-vy1*t1-4*y0-3*vy0*t1-ay0*t1^2)/t1^3;
c04=(vy1*t1-3*y1+3*y0+2*vy0*t1+ay0*t1^2/2)/t1^4;
ay1=2*c02+6*c03*t1+12*c04*t1^2;

e00=z0;
e01=vz0;
e02=az0/2;
e03=(4*z1-vz1*t1-4*z0-3*vz0*t1-az0*t1^2)/t1^3;
e04=(vz1*t1-3*z1+3*z0+2*vz0*t1+az0*t1^2/2)/t1^4;
az1=2*e02+6*e03*t1+12*e04*t1^2;
%--------------------------------------------------------------------------
b10=x1;
b11=vx1;
b12=ax1/2;
b13=(20*x2-20*x1-(8*vx2+12*vx1)*t2-(3*ax1-ax2)*t2^2)/(2*t2^3);
b14=(30*x1-30*x2+(14*vx2+16*vx1)*t2+(3*ax1-2*ax2)*t2^2)/(2*t2^4);
b15=(12*x2-12*x1-(6*vx2+6*vx1)*t2-(ax1-ax2)*t2^2)/(2*t2^5);

d10=y1;
d11=vy1;
d12=ay1/2;
d13=(20*y2-20*y1-(8*vy2+12*vy1)*t2-(3*ay1-ay2)*t2^2)/(2*t2^3);
d14=(30*y1-30*y2+(14*vy2+16*vy1)*t2+(3*ay1-2*ay2)*t2^2)/(2*t2^4);
d15=(12*y2-12*y1-(6*vy2+6*vy1)*t2-(ay1-ay2)*t2^2)/(2*t2^5);

f10=z1;
f11=vz1;
f12=az1/2;
f13=(20*z2-20*z1-(8*vz2+12*vz1)*t2-(3*az1-az2)*t2^2)/(2*t2^3);
f14=(30*z1-30*z2+(14*vz2+16*vz1)*t2+(3*az1-2*az2)*t2^2)/(2*t2^4);
f15=(12*z2-12*z1-(6*vz2+6*vz1)*t2-(az1-az2)*t2^2)/(2*t2^5);
%--------------------------------------------------------------------------

t=linspace(0,t1,20);

x01=a00+a01*t+a02*t.^2+a03*t.^3+a04*t.^4;
vx01=a01+2*a02*t+3*a03*t.^2+4*a04*t.^3;
ax01=2*a02+6*a03*t+12*a04*t.^2;

y01=c00+c01*t+c02*t.^2+c03*t.^3+c04*t.^4;
vy01=c01+2*c02*t+3*c03*t.^2+4*c04*t.^3;
ay01=2*c02+6*c03*t+12*c04*t.^2;

z01=e00+e01*t+e02*t.^2+e03*t.^3+e04*t.^4;
vz01=e01+2*e02*t+3*e03*t.^2+4*e04*t.^3;
az01=2*e02+6*e03*t+12*e04*t.^2;
%--------------------------------------------------------------------------
t=linspace(0,t2,20);

x12=b10+b11*t+b12*t.^2+b13*t.^3+b14*t.^4+b15*t.^5;
vx12=b11+2*b12*t+3*b13*t.^2+4*b14*t.^3+5*b15*t.^4;
ax12=2*b12+6*b13*t+12*b14*t.^2+20*b15*t.^3;

y12=d10+d11*t+d12*t.^2+d13*t.^3+d14*t.^4+d15*t.^5;
vy12=d11+2*d12*t+3*d13*t.^2+4*d14*t.^3+5*d15*t.^4;
ay12=2*d12+6*d13*t+12*d14*t.^2+20*d15*t.^3;

z12=f10+f11*t+f12*t.^2+f13*t.^3+f14*t.^4+f15*t.^5;
vz12=f11+2*f12*t+3*f13*t.^2+4*f14*t.^3+5*f15*t.^4;
az12=2*f12+6*f13*t+12*f14*t.^2+20*f15*t.^3;
%--------------------------------------------------------------------------
ppx=[x01 x12];ppy=[y01 y12];ppz=[z01 z12];
q1=ppx;q2=ppy;q3=ppz;

vvx=[vx01 vx12];vvy=[vy01 vy12];vvz=[vz01 vz12];
vq1=vvx;vq2=vvy;vq3=vvz;

aax=[ax01 ax12];aay=[ay01 ay12];aaz=[az01 az12];
aq1=aax;aq2=aay;aq3=aaz;

www=[q1;q2;q3;vq1;vq2;vq3;aq1;aq2;aq3];



