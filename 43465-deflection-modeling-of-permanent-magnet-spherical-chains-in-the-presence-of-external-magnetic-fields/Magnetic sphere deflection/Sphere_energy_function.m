function out1 = Sphere_energy_function(in4)
global B_mag_ext theta_B_ext Ms
%    OUT1 = SPHERE_ENERGY_FUNCTION(B_MAG_EXT,THETA_B_EXT,MS,IN4)

%    This function was generated by the Symbolic Math Toolbox version 5.7.
%    31-Jul-2013 16:22:23

gamma1 = in4(:,7);
phi1 = in4(:,1);
phi2 = in4(:,2);
phi3 = in4(:,3);
psi1 = in4(:,4);
psi2 = in4(:,5);
psi3 = in4(:,6);
t562 = cos(phi1);
t563 = sin(phi1);
t564 = t562.^2;
t565 = gamma1+psi1;
t566 = sin(t565);
t567 = t563.^2;
t568 = Ms.^2;
t569 = 1.0./pi;
t579 = t562.*(9.0./2.0e3);
t580 = cos(phi2);
t581 = t580.*(9.0./2.0e3);
t582 = cos(phi3);
t583 = t582.*(9.0./2.0e3);
t570 = t579+t581+t583;
t572 = t563.*(9.0./2.0e3);
t573 = sin(phi2);
t574 = t573.*(9.0./2.0e3);
t575 = sin(phi3);
t576 = t575.*(9.0./2.0e3);
t571 = t572+t574+t576;
t577 = gamma1+psi3;
t578 = sin(t577);
t584 = sin(gamma1);
t585 = cos(gamma1);
t586 = t570.^2;
t587 = t571.^2;
t588 = t586+t587;
t589 = cos(psi3);
t590 = sin(psi3);
t591 = t579+t581;
t592 = t572+t574;
t593 = t591.^2;
t594 = t592.^2;
t595 = t593+t594;
t596 = gamma1+psi2;
t597 = sin(t596);
t598 = cos(psi2);
t599 = sin(psi2);
t600 = 1.0./t588;
t601 = t570.*t571.*t578;
t602 = t585.*t586.*t589;
t603 = t584.*t587.*t590;
t604 = t601+t602+t603;
t605 = t562.*t571.*(9.0./1.0e3);
t606 = t605-t563.*t570.*(9.0./1.0e3);
t607 = 1.0./t595;
t608 = t585.*t593.*t598;
t609 = t584.*t594.*t599;
t610 = t591.*t592.*t597;
t611 = t608+t609+t610;
t612 = t562.*t592.*(9.0./1.0e3);
t613 = t612-t563.*t591.*(9.0./1.0e3);
t614 = t581+t583;
t615 = t574+t576;
t616 = psi1+psi3;
t617 = sin(t616);
t618 = cos(psi1);
t619 = sin(psi1);
t620 = t614.^2;
t621 = t615.^2;
t622 = t620+t621;
t623 = t580.^2;
t624 = psi1+psi2;
t625 = sin(t624);
t626 = t573.^2;
t627 = 1.0./t588.^2;
t628 = 1.0./t588.^(3.0./2.0);
t629 = 1.0./t595.^(3.0./2.0);
t630 = 1.0./t595.^2;
t631 = t573.*t614.*(9.0./1.0e3);
t632 = t631-t580.*t615.*(9.0./1.0e3);
t633 = 1.0./t622;
t634 = t589.*t618.*t620;
t635 = t590.*t619.*t621;
t636 = t614.*t615.*t617;
t637 = t634+t635+t636;
t638 = 1.0./t588.^(5.0./2.0);
t639 = gamma1-psi3;
t640 = cos(t639);
t662 = t600.*t604.*3.0;
t641 = t640-t662;
t642 = t570.*t573.*(9.0./1.0e3);
t643 = t642-t571.*t580.*(9.0./1.0e3);
t644 = gamma1-psi2;
t645 = cos(t644);
t646 = t645-t607.*t611.*3.0;
t647 = t573.*t591.*(9.0./1.0e3);
t648 = t647-t580.*t592.*(9.0./1.0e3);
t649 = 1.0./t595.^(5.0./2.0);
t650 = 1.0./t622.^2;
t651 = 1.0./t622.^(3.0./2.0);
t652 = t582.^2;
t653 = psi2+psi3;
t654 = sin(t653);
t655 = t575.^2;
t656 = t575.*t614.*(9.0./1.0e3);
t657 = t656-t582.*t615.*(9.0./1.0e3);
t658 = psi1-psi3;
t659 = cos(t658);
t660 = t659-t633.*t637.*3.0;
t661 = 1.0./t622.^(5.0./2.0);
t663 = t570.*t575.*(9.0./1.0e3);
t664 = t663-t571.*t582.*(9.0./1.0e3);
t665 = t564.*(8.1e1./4.0e6);
t666 = t567.*(8.1e1./4.0e6);
t667 = t665+t666;
t668 = t623.*(8.1e1./4.0e6);
t669 = t626.*(8.1e1./4.0e6);
t670 = t668+t669;
t671 = psi1-psi2;
t672 = sin(t671);
t673 = 1.0./t670;
t674 = cos(t624);
t675 = t573.*t580.*t674.*(8.1e1./4.0e6);
t676 = 1.0./t670.^(3.0./2.0);
t677 = t652.*(8.1e1./4.0e6);
t678 = t655.*(8.1e1./4.0e6);
t679 = t677+t678;
t680 = psi2-psi3;
t681 = sin(t680);
t682 = 1.0./t679;
t683 = cos(t653);
t684 = t575.*t582.*t683.*(8.1e1./4.0e6);
t685 = 1.0./t679.^(3.0./2.0);
t686 = sin(t658);
t687 = cos(t616);
t688 = t614.*t615.*t687;
t689 = gamma1-psi1;
t690 = sin(t689);
t691 = 1.0./t667;
t692 = cos(t565);
t693 = t562.*t563.*t692.*(8.1e1./4.0e6);
t694 = 1.0./t667.^(3.0./2.0);
t695 = sin(t639);
t696 = cos(t577);
t697 = t570.*t571.*t696;
t698 = sin(t644);
t699 = cos(t596);
t700 = t591.*t592.*t699;
out1 = [t568.*t569.*1.0./t667.^(5.0./2.0).*(t564.*t566.*(8.1e1./4.0e6)-t566.*t567.*(8.1e1./4.0e6)+t562.*t563.*t584.*t619.*(8.1e1./2.0e6)-t562.*t563.*t585.*t618.*(8.1e1./2.0e6)).*(-1.446113871795026e46./6.73998666678766e66)-t568.*t569.*t628.*(t600.*(t562.*t570.*t578.*(9.0./2.0e3)-t563.*t571.*t578.*(9.0./2.0e3)+t562.*t571.*t584.*t590.*(9.0./1.0e3)-t563.*t570.*t585.*t589.*(9.0./1.0e3)).*3.0-t604.*t606.*t627.*3.0).*(4.820379572650087e45./6.73998666678766e66)-t568.*t569.*t629.*(t607.*(t562.*t591.*t597.*(9.0./2.0e3)-t563.*t592.*t597.*(9.0./2.0e3)+t562.*t584.*t592.*t599.*(9.0./1.0e3)-t563.*t585.*t591.*t598.*(9.0./1.0e3)).*3.0-t611.*t613.*t630.*3.0).*(4.820379572650087e45./6.73998666678766e66)-t568.*t569.*t606.*t638.*t641.*(1.446113871795026e46./1.347997333357532e67)-t568.*t569.*t613.*t646.*t649.*(1.446113871795026e46./1.347997333357532e67),t568.*t569.*1.0./t670.^(5.0./2.0).*(t623.*t625.*(8.1e1./4.0e6)-t625.*t626.*(8.1e1./4.0e6)-t573.*t580.*t598.*t618.*(8.1e1./2.0e6)+t573.*t580.*t599.*t619.*(8.1e1./2.0e6)).*(-1.446113871795026e46./6.73998666678766e66)+t568.*t569.*t628.*(t600.*(t571.*t573.*t578.*(9.0./2.0e3)-t570.*t578.*t580.*(9.0./2.0e3)+t570.*t573.*t585.*t589.*(9.0./1.0e3)-t571.*t580.*t584.*t590.*(9.0./1.0e3)).*3.0-t604.*t627.*t643.*3.0).*(4.820379572650087e45./6.73998666678766e66)+t568.*t569.*t629.*(t607.*(t573.*t592.*t597.*(9.0./2.0e3)-t580.*t591.*t597.*(9.0./2.0e3)+t573.*t585.*t591.*t598.*(9.0./1.0e3)-t580.*t584.*t592.*t599.*(9.0./1.0e3)).*3.0-t611.*t630.*t648.*3.0).*(4.820379572650087e45./6.73998666678766e66)+t568.*t569.*t651.*(t633.*(t573.*t615.*t617.*(9.0./2.0e3)-t580.*t614.*t617.*(9.0./2.0e3)+t573.*t589.*t614.*t618.*(9.0./1.0e3)-t580.*t590.*t615.*t619.*(9.0./1.0e3)).*3.0-t632.*t637.*t650.*3.0).*(4.820379572650087e45./6.73998666678766e66)+t568.*t569.*t638.*t641.*t643.*(1.446113871795026e46./1.347997333357532e67)+t568.*t569.*t646.*t648.*t649.*(1.446113871795026e46./1.347997333357532e67)+t568.*t569.*t632.*t660.*t661.*(1.446113871795026e46./1.347997333357532e67),t568.*t569.*1.0./t679.^(5.0./2.0).*(t652.*t654.*(8.1e1./4.0e6)-t654.*t655.*(8.1e1./4.0e6)-t575.*t582.*t589.*t598.*(8.1e1./2.0e6)+t575.*t582.*t590.*t599.*(8.1e1./2.0e6)).*(-1.446113871795026e46./6.73998666678766e66)+t568.*t569.*t628.*(t600.*(t571.*t575.*t578.*(9.0./2.0e3)-t570.*t578.*t582.*(9.0./2.0e3)+t570.*t575.*t585.*t589.*(9.0./1.0e3)-t571.*t582.*t584.*t590.*(9.0./1.0e3)).*3.0-t604.*t627.*t664.*3.0).*(4.820379572650087e45./6.73998666678766e66)+t568.*t569.*t651.*(t633.*(t575.*t615.*t617.*(9.0./2.0e3)-t582.*t614.*t617.*(9.0./2.0e3)+t575.*t589.*t614.*t618.*(9.0./1.0e3)-t582.*t590.*t615.*t619.*(9.0./1.0e3)).*3.0-t637.*t650.*t657.*3.0).*(4.820379572650087e45./6.73998666678766e66)+t568.*t569.*t638.*t641.*t664.*(1.446113871795026e46./1.347997333357532e67)+t568.*t569.*t657.*t660.*t661.*(1.446113871795026e46./1.347997333357532e67),B_mag_ext.*Ms.*sin(psi1-theta_B_ext).*(9.01271924896123e14./1.888946593147858e22)-t568.*t569.*t651.*(t686+t633.*(t688-t589.*t619.*t620+t590.*t618.*t621).*3.0).*(4.820379572650087e45./6.73998666678766e66)+t568.*t569.*t694.*(t690-t691.*(t693-t564.*t585.*t619.*(8.1e1./4.0e6)+t567.*t584.*t618.*(8.1e1./4.0e6)).*3.0).*(4.820379572650087e45./6.73998666678766e66)-t568.*t569.*t676.*(t672+t673.*(t675-t598.*t619.*t623.*(8.1e1./4.0e6)+t599.*t618.*t626.*(8.1e1./4.0e6)).*3.0).*(4.820379572650087e45./6.73998666678766e66),B_mag_ext.*Ms.*sin(psi2-theta_B_ext).*(9.01271924896123e14./1.888946593147858e22)+t568.*t569.*t629.*(t698-t607.*(t700+t584.*t594.*t598-t585.*t593.*t599).*3.0).*(4.820379572650087e45./6.73998666678766e66)+t568.*t569.*t676.*(t672-t673.*(t675-t599.*t618.*t623.*(8.1e1./4.0e6)+t598.*t619.*t626.*(8.1e1./4.0e6)).*3.0).*(4.820379572650087e45./6.73998666678766e66)-t568.*t569.*t685.*(t681+t682.*(t684-t589.*t599.*t652.*(8.1e1./4.0e6)+t590.*t598.*t655.*(8.1e1./4.0e6)).*3.0).*(4.820379572650087e45./6.73998666678766e66),B_mag_ext.*Ms.*sin(psi3-theta_B_ext).*(9.01271924896123e14./1.888946593147858e22)+t568.*t569.*t628.*(t695-t600.*(t697+t584.*t587.*t589-t585.*t586.*t590).*3.0).*(4.820379572650087e45./6.73998666678766e66)+t568.*t569.*t651.*(t686-t633.*(t688-t590.*t618.*t620+t589.*t619.*t621).*3.0).*(4.820379572650087e45./6.73998666678766e66)+t568.*t569.*t685.*(t681-t682.*(t684-t590.*t598.*t652.*(8.1e1./4.0e6)+t589.*t599.*t655.*(8.1e1./4.0e6)).*3.0).*(4.820379572650087e45./6.73998666678766e66),t584.*t585.*(4.318227911642191e15./7.205759403792794e16)+B_mag_ext.*Ms.*sin(gamma1-theta_B_ext).*(9.01271924896123e14./1.888946593147858e22)-t568.*t569.*t628.*(t695+t600.*(t697-t584.*t586.*t589+t585.*t587.*t590).*3.0).*(4.820379572650087e45./6.73998666678766e66)-t568.*t569.*t629.*(t698+t607.*(t700-t584.*t593.*t598+t585.*t594.*t599).*3.0).*(4.820379572650087e45./6.73998666678766e66)-t568.*t569.*t694.*(t690+t691.*(t693-t564.*t584.*t618.*(8.1e1./4.0e6)+t567.*t585.*t619.*(8.1e1./4.0e6)).*3.0).*(4.820379572650087e45./6.73998666678766e66)];
